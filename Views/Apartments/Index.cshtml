@model IEnumerable<FPRMAspNetCoreMVC.Models.Apartment>

@{
    ViewData["Title"] = "Apartments";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="col-md-6">
    <h1 class="float-start">@ViewData["Title"]</h1>
    <br>
</div>

<div>
    @if ((bool)ViewBag.ShowCreateButton)
    {
        <a class="btn btn-primary float-end" asp-action="Create">New Apartment</a>
    }
    <br><br>
    <form asp-action="Index" method="get">
        <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="Search for Building, Unit, Price, Type, ..." name="filter">
            <div class="input-group-text">
                <input type="checkbox" id="onlyAvailable" name="onlyAvailable" value="true">
                <label for="onlyAvailable"> Only Available? </label>
            </div>
            <button class="btn btn-outline-secondary" type="submit">Search</button>
            <button type="submit" class="btn btn-link" name="clearFilter">Clear Filter</button>

        </div>
        <input type="hidden" name="onlyAvailable" value="false">
    </form>
</div>
<table class="table table-hover">
    <thead class="table-secondary">
    <tr>
        <th style="width: 10%;">Image</th>
        <th style="width: 10%;">Building</th>
        <th style="width: 10%;">@Html.DisplayNameFor(model => model.Unit)</th>
        <th style="width: 10%;">@Html.DisplayNameFor(model => model.TypeApartment)</th>
        <th style="width: 20%;">@Html.DisplayNameFor(model => model.Description)</th>
        <th style="width: 10%;">@Html.DisplayNameFor(model => model.Bathrooms)</th>
        <th style="width: 10%;">@Html.DisplayNameFor(model => model.Area)</th>
        <th style="width: 10%;">@Html.DisplayNameFor(model => model.RentAmount)</th>
        <th style="width: 15%;">@Html.DisplayNameFor(model => model.RegistrationDate)</th>
        <th style="width: 5%;">@Html.DisplayNameFor(model => model.IsAvailable)</th>
        <th style="width: 10%;"></th>
    </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @if (item.ImageData != null && item.ImageData.Length > 0)
                    {
                        <img src="data:image;base64,@Convert.ToBase64String(item.ImageData)" alt="Building Image" style="max-width: 250px; max-height: 250px;" />
                    }
                    else
                    {
                        <span>No image available</span>
                    }
                </td>

                <td style="width: 10%;">@Html.DisplayFor(modelItem => item.Building.Name)</td>
                <td style="width: 10%;">@Html.DisplayFor(modelItem => item.Unit)</td>
                <td style="width: 10%;">@Html.DisplayFor(modelItem => item.TypeApartment)</td>
                <td style="width: 20%;">@Html.DisplayFor(modelItem => item.Description)</td>
                <td style="width: 10%;">@Html.DisplayFor(modelItem => item.Bathrooms)</td>
                <td style="width: 10%;">@Html.DisplayFor(modelItem => item.Area)</td>
                <td style="width: 10%;">@Html.DisplayFor(modelItem => item.RentAmount)</td>
                <td style="width: 15%;">@Html.DisplayFor(modelItem => item.RegistrationDate)</td>
                <td style="width: 5%;">@Html.DisplayFor(modelItem => item.IsAvailable)</td>
                <td>
                    @if (ViewBag.ShowEditButton)
                    {
                        <a class="btn btn-warning" asp-action="Edit" asp-route-id="@item.Id"><i class="bi bi-pencil"></i></a>
                    }
                    @if (ViewBag.ShowDetailsButton)
                    {
                        <a class="btn btn-info" asp-action="Details" asp-route-id="@item.Id"><i class="bi bi-info"></i></a>
                    }
                    @if (ViewBag.ShowDeleteButton)
                    {
                        <a class="btn btn-danger" asp-action="Delete" asp-route-id="@item.Id"><i class="bi bi-trash"></i></a>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>
